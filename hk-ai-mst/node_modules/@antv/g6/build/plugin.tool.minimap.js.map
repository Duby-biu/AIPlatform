{"version":3,"file":"plugin.tool.minimap.js","sources":["webpack://[name]/plugin.tool.minimap.js"],"sourcesContent":["!function(t,e){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e(require(\"@antv/g6\")):\"function\"==typeof define&&define.amd?define([\"@antv/g6\"],e):\"object\"==typeof exports?exports[\"plugin.tool.minimap\"]=e(require(\"@antv/g6\")):t[\"plugin.tool.minimap\"]=e(t.G6)}(window,function(t){return function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,\"a\",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p=\"\",i(i.s=261)}({260:function(t,e,i){function n(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);\"function\"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){r(t,e,i[e])})}return t}function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var o=i(4),a=o.Util,c=o.G.Canvas,u=function(){function t(t){a.mix(this,n({type:\"minimap\",container:null,isMinimap:!0,backgroundCSS:{height:\"100%\",position:\"absolute\",margin:\"auto\",left:0,right:0,\"z-index\":0},minimapContainerCSS:{background:\"#fff\",position:\"relative\",overflow:\"hidden\"},viewportCSS:{height:\"100%\",position:\"absolute\",margin:\"auto\",left:0,right:0,\"z-index\":1},controlLayerCSS:{width:\"100%\",height:\"100%\",cursor:\"move\",position:\"absolute\",\"z-index\":2},viewportWindowStyle:{stroke:\"#91D5FF\"},viewportBackStyle:{fill:\"#EBEEF2\",fillOpacity:.65},getGraph:function(){}},t)),this._initContainer(),this._initMiniMap(),this._bindEvent(),this._assignRenderBackground()}var e=t.prototype;return e._assignRenderBackground=function(){var t=this;this.renderBackground=a.debounce(function(e){e||(e=t.getGraph());var i=t.miniMapCanvas,n=t.width,r=t.height,o=[];a.graph2Canvas({graph:e,width:n,height:r,canvas:i,beforeTransform:function(t){var i=t[0];e.getNodes().forEach(function(t){var e=t.getBBox(),n=t.getModel(),r=e.width;if(r*i<2){var c=t.getGraphicGroup(),u=a.clone(c.getMatrix());c.transform([[\"t\",-n.x,-n.y],[\"s\",2/(r*i),2/(r*i)],[\"t\",n.x,n.y]]),o.push({item:t,originMatrix:u})}})},afterTransform:function(){o.forEach(function(t){var e=t.item,i=t.originMatrix;e.getGraphicGroup().setMatrix(i)})}}),t.miniMapMatrix=i.matrix},32)},e._bindEvent=function(){var t,e,i,n,r,o=this,c=this.controlLayer,u=!1;function s(){u=!1,e=void 0,n=void 0,t=void 0,i=void 0,r=void 0}c.on(\"mousedown\",function(c){o.miniMapMatrix&&(r=o.getGraph(),u=!0,t=a.cloneDeep(r.getMatrix()),e=o.miniMapMatrix[0],i=t[0],n={clientX:c.clientX,clientY:c.clientY})}),c.on(\"mouseup\",function(){s()}),c.on(\"mouseleave\",function(){s()}),c.on(\"mousemove\",function(o){if(u&&r){var c=n.clientX-o.clientX,s=n.clientY-o.clientY,h=a.cloneDeep(t);a.mat3.translate(h,h,[i*c/e,i*s/e]),r.updateMatrix(h)}})},e._initMiniMap=function(){var t=this.background,e=this.viewPort,i=this.width,r=this.height,o=this.viewportWindowStyle,a=this.viewportBackStyle,u=new c({containerDOM:t,width:i,height:r}),s=new c({containerDOM:e,width:i,height:r}),h=s.addShape(\"rect\",{attrs:n({x:0,y:0,width:i,height:r},o)}),p=s.addShape(\"path\",{attrs:n({path:\"M0,0 L1,1\"},a)});t.css({width:i+\"px\",height:r+\"px\"}),e.css({position:\"absolute\"}),this.miniMapCanvas=u,this.viewportCanvas=s,this.viewportWindow=h,this.viewportBack=p},e._initContainer=function(){var t=this.container,e=this.width,i=this.height;if(!t)throw new Error(\"please set the container for the minimap !\");a.isString(t)&&(t=document.getElementById(t)),e||(e=a.getWidth(t),this.width=e),i||(i=a.getHeight(t),this.height=i);var n=this.minimapContainerCSS;n.width=e+\"px\",n.height=i+\"px\";var r=this.backgroundCSS,o=this.viewportCSS,c=this.controlLayerCSS,u=a.createDOM('<div class=\"g6-editor-minimap-container\"></div>',n),s=a.createDOM('<div class=\"g6-editor-minimap-background\"></div>',r),h=a.createDOM('<div class=\"g6-editor-minimap-viewport\">',o),p=a.createDOM('<div class=\"g6-editor-minimap-control-layer\">',c);t.appendChild(u),u.appendChild(p),u.appendChild(h),u.appendChild(s),this.minimapContainer=u,this.background=s,this.viewPort=h,this.controlLayer=p},e.renderViewPort=function(t){if(t||(t=this.getGraph()),0!==t.getItems().length){var e=this.viewportWindow,i=this.viewportCanvas,n=this.viewportBack,r=this.miniMapMatrix,o=t.getWidth(),c=t.getHeight(),u=this.width,s=this.height,h=t.getMatrix();if(r){var p=a.invertMatrix({x:0,y:0},h),d=a.invertMatrix({x:o,y:c},h),f=a.applyMatrix(p,r),l=a.applyMatrix(d,r),g=l.x-f.x,v=l.y-f.y;n.attr({path:[[\"M\",0,0],[\"L\",u,0],[\"L\",u,s],[\"L\",0,s],[\"L\",0,0],[\"M\",f.x,f.y],[\"L\",f.x,l.y],[\"L\",l.x,l.y],[\"L\",l.x,f.y],[\"L\",f.x,f.y]]}),e.attr({x:f.x,y:f.y,width:g,height:v}),i.draw()}}},e.destroy=function(){this.minimapContainer.destroy()},t}();t.exports=u},261:function(t,e,i){function n(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var r=i(4),o=i(260),a=function(){function t(t){this.options=t}var e=t.prototype;return e.init=function(){var t=this.graph,e=new o(function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},r=Object.keys(i);\"function\"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),r.forEach(function(e){n(t,e,i[e])})}return t}({getGraph:function(){return t}},this.options));t.on(\"afterchange\",function(){e.renderBackground(),e.renderViewPort()}),t.on(\"afterlayout\",function(){e.renderBackground(),e.renderViewPort()}),t.on(\"afterviewportchange\",function(){e.renderViewPort()}),t.on(\"afterfilter\",function(){e.renderBackground(),e.renderViewPort()}),this.renderBackground=function(){e.renderBackground()},this.renderViewPort=function(){e.renderViewPort()},this.minimap=e},e.destroy=function(){this.minimap.destroy()},t}();r.Plugins[\"tool.minimap\"]=a,t.exports=a},4:function(e,i){e.exports=t}})});"],"mappings":"AAAA","sourceRoot":""}